---
layout: post
title: "게시글 조회수 중복 증가 이슈에 대하여"
date: 2020-04-02 00:00:00 -0400
background: '/img/bg-post.jpg'
---

<p>
게시글 조회수 중복 증가 이슈에 대하여<br>
<br>
[간단한 이해]<br>
일반적으로 조회수 조작 방지를 위해서 아래와 같은 3가지 방식을 사용한다.<br>
<br>
1. 쿠키(Cookie)<br>
2. 세션(Session)<br>
3. IP<br>
<br>
각각의 방식에는 장단점이 분명하게 존재한다.<br>
잘 알다시피 쿠키는 클라이언트측에 정보를 저장하고, 세션은 서버측에 저장한다.<br>
따라서 세션을 사용하면 서버측에 부하를 줄 수 있다.<br>
IP별로 중복 검사를 하기 위해서는, IP 테이블을 따로 저장, 보관해야하며. 이에 따른 비용이 제일 많이 발생한다.<br>
또한 IP는 내부사설망(가상아이피)을 사용하면 오히려 정당한 조회수 증가가 불가하는 경우가 생길 수 있다.<br>
<br>
비용(부하) 적게 드는 방법<br>
쿠키 >> 세션 >> IP<br>
<br>
중복을 확실하게 막는 방법<br>
IP >> 세션 >> 쿠키<br>
<br>
이에따라 일반적으로 조회수가 그렇게 중요한 특성을 나타내는 게시물이 아닐 경우,<br>
손쉽게 구현가능하며, 비용(부하)도 적게 드는 쿠키로 시간을 설정하여 조회수 증가를 연속적으로 하지 못하게 막는다.<br>
<br>
발생가능한 예외상황<br>
클라이언트(브라우저)상에서 쿠키를 사용하지 않도록 설정하는 경우<br>
이럴 경우에는, 쿠키생성이 안됐을 때의 조건으로 예외처리하여 조회수 증가를 아예 막는 방법을 사용할 수 있다.<br>
<br>
<br>
[구현 방법]<br>
- 한 게시물 당 쿠키를 생성하여 동일한 게시물에서 새로고침(F5)를 누를 경우, 또는 재진입할 경우에 조회수 증가 중복을 막는다.<br>
- 쿠키의 시간 제한은 1분(60초)로 setcookie('쿠키명', '쿠키값', time() + 60); 식으로 설정한다.<br>
- 다시 동일한 게시물 페이지에 진입했을 경우 쿠키 설정값을 확인하여 만료되지 않았다면, 조회수를 증가시키는 SP를 실행시키지 않는다.<br>
</p>

<p></p>
